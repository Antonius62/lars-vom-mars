<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Lars vom Mars</title>
    <link rel="manifest" href="./manifest.json">
    <meta name="theme-color" content="#000000">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <meta name="apple-mobile-web-app-title" content="Lars vom Mars">
    <link rel="apple-touch-icon" href="./Lars_App_Icon.png">
    <style>
        /* Reset */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* Base Styles */
        body {
            margin: 0;
            padding: 0;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            background-image: url('./mars_background.png');
            background-size: cover;
            background-position: center;
            background-attachment: fixed;
            color: white;
            font-family: Arial, sans-serif;
            position: relative;
            overflow-x: hidden;
        }

        /* Header */
        .app-header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            text-align: center;
            padding: 10px;
            z-index: 1000;
        }

        .app-title {
            font-size: 1.5em;
            text-shadow: 2px 2px 4px black;
            color: rgba(255,255,255,0.5);
            line-height: 1.4;
        }

        /* Navigation */
        .nav-container {
            position: fixed;
            bottom: 20px;
            left: 0;
            right: 0;
            display: flex;
            justify-content: center;
            gap: 20px;
            padding: 10px;
            z-index: 1000;
        }

        .nav-button {
            width: 90px;
            height: 90px;
            border-radius: 50%;
            border: none;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            color: black;
            transition: transform 0.2s;
        }

        .nav-button:hover {
            transform: scale(1.1);
        }

        .nav-button.audiobook { background: rgba(255,255,0,0.6); }
        .nav-button.video { background: rgba(173,216,230,0.6); }
        .nav-button.music { background: rgba(255,160,160,0.6); }
        .nav-button.action { background: rgba(144,238,144,0.6); }

        /* Mobile Optimization */
        @media (max-width: 480px) {
            .nav-button {
                width: 70px;
                height: 70px;
                font-size: 14px;
            }
            .nav-container {
                gap: 15px;
                bottom: 10px;
            }
        }

        /* Library Modal */
        .library-modal {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 95%;
            max-width: 1100px;
            max-height: 90vh;
            background: transparent;
            border-radius: 20px;
            padding: 40px;
            z-index: 1001;
            overflow-y: auto;
        }

        .library-grid {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 20px;
            margin-top: 20px;
        }

        .library-item {
            aspect-ratio: 1;
            border-radius: 50%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            position: relative;
            transition: all 0.3s ease;
        }

        /* Player Controls */
        .player-controls {
            display: none;
            position: absolute;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
            width: 90%;
            text-align: center;
        }

        .progress-bar {
            width: 100%;
            height: 4px;
            background: rgba(255,255,255,0.3);
            border-radius: 2px;
            margin: 5px 0;
        }

        .progress {
            width: 0%;
            height: 100%;
            background: rgba(255,255,0,0.8);
            border-radius: 2px;
            transition: width 0.1s linear;
        }

        /* Lyrics Container */
        .lyrics-container {
            position: fixed;
            bottom: 150px;  
            left: 50%;
            transform: translateX(-50%);
            width: 80%;
            max-width: 800px;
            padding: 30px;
            text-align: center;
            font-size: 1.8em;
            font-family: "Comic Sans MS", "Comic Sans", cursive;
            color: #ffffff;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.5);
            opacity: 0;
            transition: opacity 0.5s ease-in-out;
            z-index: 999;
        }

        .lyrics-container.visible {
            opacity: 1;
        }

        /* Animation für Liedtext-Zeilen */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .lyrics-line {
            opacity: 0;
            animation: fadeInUp 1s ease-out forwards;
            margin: 10px 0;
            padding: 5px 20px;
            border-radius: 10px;
            background: rgba(0,0,0,0.3);
        }

        /* Verzögerung für jede Zeile */
        .lyrics-line:nth-child(1) { animation-delay: 0.5s; }
        .lyrics-line:nth-child(2) { animation-delay: 1.5s; }
        .lyrics-line:nth-child(3) { animation-delay: 2.5s; }
        .lyrics-line:nth-child(4) { animation-delay: 3.5s; }
        .lyrics-line:nth-child(5) { animation-delay: 4.5s; }

        @media (max-width: 768px) {
            .lyrics-container {
                font-size: 1.4em;
                bottom: 120px;
                padding: 20px;
            }
        }
    </style>
</head>
<body>
    <header class="app-header">
        <h1 class="app-title">Willkommen in der Welt von Lars vom Mars</h1>
    </header>

    <nav class="nav-container">
        <button class="nav-button audiobook" onclick="handleButtonClick('audiobook')">Hörbuch</button>
        <button class="nav-button video" onclick="handleButtonClick('video')">Video</button>
        <button class="nav-button music" onclick="toggleMusic()">Musik</button>
        <button class="nav-button action" onclick="playQuackSound()">Action</button>
    </nav>

    <div id="audiobookModal" class="library-modal">
        <div class="library-grid">
            <!-- Audiobook chapters will be dynamically added here -->
        </div>
    </div>

    <div id="videoModal" class="library-modal">
        <div class="library-grid">
            <!-- Video chapters will be dynamically added here -->
        </div>
    </div>

    <div class="lyrics-container">
        <!-- Lyrics will be dynamically added here -->
    </div>

    <script>
        // Musik und Liedtext-System
        let musicPlaying = false;
        const song = new Audio('./lars_vom_mars_song.wav');
        const lyricsContainer = document.querySelector('.lyrics-container');
        
        const lyrics = [
            "Lars vom Mars, unser Freund aus dem All",
            "Kommt zu uns auf die Erde, besucht uns überall",
            "Mit seinem Raumschiff fliegt er durch Zeit und Raum",
            "Erlebt Abenteuer, es ist wie ein Traum",
            "Lars vom Mars, Lars vom Mars, komm und flieg mit uns!"
        ];

        function toggleMusic() {
            if (!musicPlaying) {
                song.play();
                musicPlaying = true;
                showLyrics();
            } else {
                song.pause();
                song.currentTime = 0;
                musicPlaying = false;
                hideLyrics();
            }
        }

        function showLyrics() {
            lyricsContainer.innerHTML = '';
            lyrics.forEach((line, index) => {
                const div = document.createElement('div');
                div.className = 'lyrics-line';
                div.textContent = line;
                lyricsContainer.appendChild(div);
            });
            lyricsContainer.classList.add('visible');
        }

        function hideLyrics() {
            lyricsContainer.classList.remove('visible');
            setTimeout(() => {
                lyricsContainer.innerHTML = '';
            }, 500);
        }

        // Quack Sound für Action-Button
        function playQuackSound() {
            const audio = new Audio('./quack_sound.mp3');
            audio.play();
        }

        // Bibliotheks-System
        function handleButtonClick(type) {
            const modal = document.getElementById(type + 'Modal');
            if (modal.style.display === 'block') {
                modal.style.display = 'none';
            } else {
                // Hide other modals
                document.querySelectorAll('.library-modal').forEach(m => m.style.display = 'none');
                modal.style.display = 'block';
            }
        }

        // Service Worker Registration
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js')
                    .then(registration => {
                        console.log('ServiceWorker registration successful');
                    })
                    .catch(err => {
                        console.log('ServiceWorker registration failed: ', err);
                    });
            });
        }
    </script>
</body>
</html>
